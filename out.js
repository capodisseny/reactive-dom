(()=>{var re="s-",Q={onclick:!0,ondblclick:!0,onmousedown:!0,onmouseup:!0,onmousemove:!0,onmouseover:!0,onmouseout:!0,onmouseenter:!0,onmouseleave:!0,oncontextmenu:!0,onkeydown:!0,onkeyup:!0,onkeypress:!0,onchange:!0,onsubmit:!0,onreset:!0,oninput:!0,oninvalid:!0,onselect:!0,onload:!0,onunload:!0,onresize:!0,onscroll:!0,onbeforeunload:!0,onhashchange:!0,onerror:!0,onDOMContentLoaded:!0,onreadystatechange:!0,oncopy:!0,oncut:!0,onpaste:!0,ondrag:!0,ondragstart:!0,ondragend:!0,ondragover:!0,ondragenter:!0,ondragleave:!0,ondrop:!0,onplay:!0,onpause:!0,onended:!0,ontimeupdate:!0,onvolumechange:!0,onseeked:!0,onseeking:!0,ondurationchange:!0,oncanplay:!0,oncanplaythrough:!0,ontouchstart:!0,ontouchend:!0,ontouchmove:!0,ontouchcancel:!0,onpointerdown:!0,onpointerup:!0,onpointermove:!0,onpointerover:!0,onpointerout:!0,onpointerenter:!0,onpointerleave:!0,onpointercancel:!0,onfocus:!0,onblur:!0,onfocusin:!0,onfocusout:!0,ondeviceorientation:!0,ondevicemotion:!0,ontransitionend:!0,onanimationstart:!0,onanimationend:!0,onanimationiteration:!0,onmessage:!0,ononline:!0,onoffline:!0,onstorage:!0},H={bind:{updateFunction(n,{oldValue:e,value:t}){typeof t=="object"&&Object.entries(t).forEach(([s,r])=>{n.setAttribute(s,r)})}},show:{updateFunction:(n,{value:e})=>{let t=e?[""]:["none","important"];n.style.setProperty("display",...t)}},if:{updateFunction(n,{value:e}){let t=nodeRef.commentRef=nodeRef.commentRef||document.createComment("if");if(e){if(n.parentNode)return;t.replaceWith(n)}else n.replaceWith(t)}},loop:{deep:1,resolveExpression(n){return n.match(/([a-zA-Z]+)(?:\s*,\s*([a-zA-Z]+))?\s+in\s+([a-zA-Z.]+)/).slice(1)},getValue({expression:n},e){let[t,s,r]=n;return $(e,r)},createChildContext({path:n,obj:e,ctx:t,loopKey:s,loopIndex:r}){return{data:new Proxy(t.data,{get(i,o){if(o==r)return e.key;if(o==s){let a=e.key;return $(i,`${n}.${a}`)}return Reflect.get(i,o)},set(i,o,a){return o==r?!0:o==s?J(i,`${n}.${e.key}`,a):Reflect.set(i,o,a)}}),isLoop:!0}},updateFunction(n,e,{expression:t,helper:s},r){let{type:i,target:o,key:a,value:c,updateId:d,oldValue:p}=e,[l,u,U]=t,x=c,O=(f,y)=>{let E=document.createElement("div");return f.push(E),y&&E.append(...y.childNodes),E},M=s.node.content;if(n.parentNode,!x)return;let k=this.getNodeObject(n),te=k.lastLoop||[],m=we(x,te),I=m.jobs;if((I.length===1?I[0]:!1)=="keep")return;let T=k.loopValues=k.loopValues||new Map,P=[],F=[],K=r.isLoop;if(m.toAdd.length==m.toRemove.length&&!m.toReposition.length&&m.types.length==1&&m.types[0]!="object")return;let L=[];m.toKeep.forEach(([f,y],E)=>{let g=T.get(f),h=K?O(F):document.createDocumentFragment();h.append(...g.nodes),P[f]=h}),m.toRemove.forEach(([f,y],E)=>{let g=T.get(f);L.push(()=>T.delete(f)),g.nodes.forEach(h=>h.remove())}),m.toReposition.forEach(([f,y,E],g)=>{let h=T.get(E);L.push(()=>T.set(f,h));let b=K?O(F):document.createDocumentFragment();b.append(...h.nodes),h.key=f,ge(b,h.ctx),P[f]=b}),m.toAdd.forEach(([f,y],E)=>{let g={key:f,item:y},h=this.createChildContext({path:U,obj:g,ctx:r,loopKey:l,loopIndex:u});L.push(()=>T.set(f,g)),g.ctx=h;let b=M.cloneNode(!0);M.childNodes.forEach((ne,se)=>{ee(ne,b.childNodes[se],h)}),r.isLoop&&b.nodeType==11&&(b=O(F,b)),g.nodes=[...b.childNodes],P[f]=b}),L.forEach(f=>f()),x.length!=P.length,n.__inTemplate,G(),requestAnimationFrame(()=>{n.before(...P)}),F.forEach(f=>f.replaceWith(...f.childNodes)),k.lastLoop=[...x]}}};window.createContext=ie;window.reactive=q;window.watch=Z;window.nextTick=v;function ie(n,e){e=e||ue()||document.body,typeof n=="string"&&(n=q({}));let t={data:n,root:e},s=de(e);return pe(t),{}}var B={reactive:new WeakMap},ve=Symbol("__isProxy");function z(n){return n?n?.__isReactive:!1}var R={__isReactive:{get(n,e,t,s){return this.proxy==s}},__raw:{get(n){return n}}};function q(n,e=[],t,s,r){if(typeof n!="object")return n;if(z(n))return n.__parent=t,n.__key=s,n;let i=B.reactive.get(n);if(i)return i;let o=new _({target:n,parent:t,key:s,origin:r||n,callbacks:e}),a=new Proxy(n,o);return o.proxy=a,B.reactive.set(n,a),a}var V=[],_=class n{static handlers=[];static queue=[];static handlersByObject=new WeakMap;constructor(e={}){this.effects=new Set,this.constructor.handlers.push(this),this.origin=e.origin,this.target=e.target,this.queue=[],this.parent=e.parent,this.key=e.key,this.deepEffects=new Set,e.callbacks&&this.addDeepEffect(e.callbacks),this.constructor.handlersByObject.set(this.target,this)}runEffect(e,t){if(e.ran)return;v(()=>e.ran=!1);let r=typeof e=="function"?!0:e.deep;if(t&&r){if(r!==!0&&t>r)return;this.runNextUpdate(e)}if(!t){let i=e.observing.get(this);this.runNextUpdate(e,i)}}runDeep(){let e=1,t=this,s=[],r="";for(;t;)t.key&&(r=`${t.key}.${r}`),s.push([t,e,r]),t=t.parent,e++;s.reverse(),s.forEach(([i,o,a])=>{let c={path:a};i.deepEffects.forEach(d=>{this.runEffect(d,o)})})}runNextUpdate(e,t=this.nextUpdate){Object.keys(t).forEach(s=>{if(typeof e=="function"){e(this.nextUpdate[s],this);return}e.runWithPayload(this.nextUpdate[s],this)})}addDeepEffect(e){let t=this.deepEffects;typeof e=="function"||e instanceof W?t.add(e):Array.isArray(e)&&t.forEach(s=>{this.addDeepEffect(s)})}static get currentEffect(){return V.at(-1)}static set currentEffect(e){return e?V.push(e):V.pop(),!0}static getHandler(e){return this.handlersByObject.get(Y(e))}addEffect(e,t,s){this.effects.has(e)||this.effects.add(e),e.observeProp(this,t)}get(e,t,s){let r=e[t];if(R[t]?.get)return R[t].get.call(this,e,t,r,s);let i=this.constructor.currentEffect;return i&&this.addEffect(i,t),typeof r=="object"?q(r,!1,this,t,this.origin):(Array.isArray(e),r)}set(e,t,s,r){if(R[t]?.set)return R[t].set.call(this,e,t,s,r);let i,o=e[t];return Array.isArray(e),e[t]=s,this.queueMutation({type:"set",target:e,key:t,oldKey:i,value:s,oldValue:o,origin:this.origin}),!0}deleteProperty(e,t){if(t in e){let s=e[t],r;return Array.isArray(e)&&(r=e.indexOf(s)),delete e[t],this.queueMutation({type:"delete",value:e[t],oldKey:r,target:e,key:t,oldValue:s,origin:this.origin}),!0}}triggerUpdate(){this.runDeep(),this.effects.forEach(e=>{this.runEffect(e)}),this.nextUpdate=!1}static runUpdates(){for(;this.queue.length;)this.queue.shift().triggerUpdate();this.updating=!1,C.runNextTick()}queueMutation(e){n.queue.includes(this)||n.queue.push(this),this.nextUpdate=this.nextUpdate||{},this.nextUpdate[e.key]=e,n.updating||(n.updating=!0,Promise.resolve().then(()=>{n.runUpdates()}))}};function oe(n,e){e={...e||{}},new W(n,e)}var W=class n{onTrigger=!1;handler=!1;immediate=!0;deep=!1;static eventTarget=new EventTarget;static observingTarget=new WeakMap;static setTargetObserver(e,t){t=Y(t);let s=_.getHandler(t);s&&s.addDeepEffect(e)}constructor(e,t){let s=["immediate","callback","onTrigger","deep","updater"];this.source=e,typeof e=="object"&&(this.deep=1,n.setTargetObserver(this,e)),s.forEach(i=>{t.hasOwnProperty(i)&&(this[i]=t[i])}),this.observing=new WeakMap;let r=this.runWithPayload({});this.immediate&&this.callback&&this.callback.call(void 0,{value:r}),this.nextUpdate={}}runWithPayload(e,t){let s=this.source,r;return _.currentEffect=this,typeof s=="function"&&(r=s(e,t)),this.lastValue=r,this.deep&&z(r)&&n.setTargetObserver(this,r),_.currentEffect=!1,this.callback&&this.callback.call(void 0,e),r}observeProp(e,t){let s=this.observing.get(e);s||(s={},this.observing.set(e,s)),s[t]=!0}};function Z(n,e,t){let r={callback:e,immediate:typeof t=="boolean"?t:!1,...t||{}},i=typeof n;i!=="object"&&i!=="function"||oe(n,r)}function J(n,e,t){e?.split;let s=e.split("."),r=n,i=s.pop();for(let o of s){if(!r)return;r=r[o]}r[i]=t}var C=class n{static isRendering=!1;static runNextTick(){if(this.isRendering)return;this.isRendering=!0;let e=n.nextTickQueue;requestAnimationFrame(()=>{for(;e.length;)e.shift()();this.isRendering=!1})}static nextTickQueue=[]};function v(n){C.nextTickQueue.push(n)}var ae=new Map;C.getCache=ae;function $(n,e){e?.split;let t=e.split("."),s=n,r;for(let i of t){if(!s){r=void 0;break}s=s[i]}return r=s,r}function ue(){return document.currentScript.previousElementSibling}var S=class{constructor(){this.map=new Map,this.idMap=new Map}get(e){if(e?.__sId)return this.idMap.get(e.__sId);let t=e?.getAttribute?e.getAttribute("__sId"):!1;return t?this.idMap.get(t):this.map.get(e)}set(e,t){return this.map.set(e,t),this.idMap.set(t.id,t)}has(e){return this.map.has(e)}getByDepth(e){return this.idMap.get(e)}},N=new S;var ce=0,D=[];function X(n,e,t){D.push([n,e,t])}var j=!1;function G(n){if(!j){for(j=!0;D.length;){let[e,t,s]=D.pop();s?ee(e,t,s):N.get(e).runNodeUpdates(e,s||n)}j=!1}}function le(n,e){if(n.__sCompiled)return N.get(n);let t={updaters:{}};n.dataset;let s=!1;if(n.tagName!=="TEMPLATE"&&(n.__inTemplate=e),n.nodeType==n.TEXT_NODE&&n.textContent.includes("{{")){s=!0;let r=he(n.textContent);r=r.map(i=>{if(i.path){let a=document.createTextNode(`{{${i.path}}}`);return a.__inTemplate=e,new A(a).addUpdate("text",{expression:i.path}),a}let o=document.createTextNode(i);return o.__inTemplate=e,o}),n.replaceWith(...r)}if(n.attributes?.length){let r,i=n.attributes;Object.values(i).forEach(o=>{let a=o.value,c=o.name;if(c.startsWith(re)){r=r||new A(n);let d=c.slice(2);H[d]&&(s=!0,r.addUpdate(d,{expression:a.slice(2,-2)}),n.removeAttribute(c));return}if(Q[c]){r=r||new A(n),r.addUpdate("events",{expression:a,key:c.slice(2)}),n.removeAttribute(c);return}a.includes("{{")&&(r=r||new A(n),r.addUpdate("attrs",{expression:a.trim().slice(2,-2),key:c}))})}if(n.tagName=="TEMPLATE"){let r=document.createComment("template");r.__inTemplate=e;let i=N.get(n);n.replaceWith(r),r.__sId=i.id,r.id=i.id,X(r),i.root=r,document.body.append(n)}return{}}function de(n){let e=!1;return fe(n,t=>{(t.parentNode?.nodeType===11||t.textContent=="template")&&(e=t.parentNode),(t.previousSibling?.tagName=="TEMPLATE"||t.previousSibling?.textContent=="template")&&(e=!1),le(t,e)}),N}function pe(n){let{show:e,text:t,loop:s,attrs:r}=w.updaters;G(n)}function fe(n,e){let t=[n];for(;t.length>0;){let s=t.pop();if(s.hasAttribute&&s.hasAttribute("s-loop")&&s.tagName!=="TEMPLATE"){let i=document.createElement("template");i.setAttribute("s-loop",s.getAttribute("s-loop")),s.removeAttribute("s-loop"),s.after(i),i.content.appendChild(s),s=i}let r=s.tagName=="TEMPLATE"?s.content.childNodes:s.childNodes;e(s);for(let i=r.length-1;i>=0;i--)t.push(r[i])}}function he(n){let e=[],t=0,s=n.indexOf("{{");for(;s!==-1;){if(t!==s){let o=n.slice(t,s);e.push(o)}let r=n.indexOf("}}",s);if(r===-1)break;let i=n.slice(s+2,r).trim();e.push({path:i}),t=r+2,s=n.indexOf("{{",t)}if(t<n.length){let r=n.slice(t);e.push(r)}return e}function ge(n,e){let t=[n];for(;t.length;){let s=t.pop(),r=N.get(s);r&&r.runNodeUpdates(s,e,!0);let i=s.childNodes;for(let o=i?.length-1;o>=0;o--)t.push(i[o])}}function me(n,e,t){let s=[[n,e]];for(;s.length;){let[r,i]=s.pop();i?.childNodes;let o=r.childNodes,a=i.childNodes;t(r,i);for(let c=o.length-1;c>=0;c--)s.push([o[c],a[c]])}}var A=class{node=!1;updates=[];constructor(e,t={}){let s=["updaters"];this.id=`id-${ce++}`,this.node=e,e.inTemplate?this.inTemplate=!0:e.tagName!=="TEMPLATE"&&X(e),N.set(e,this),e.__sCompiled}addUpdate(e,t){let s=w.getInstance(e);if(!s)return;let r=s.registerHelper(this,t);this.updates.push({updater:s,payload:r})}runNodeUpdates(e,t,s){e.__sId||(e.__sId=this.id),Object.values(this.updates).forEach(r=>{s?r.updater.forceUpdate(e,r.payload,t):r.updater.runNodeUpdate(e,r.payload,t,r)})}},w=class{priority=10;static updaters={};constructor(e){this.constructor.updaters[e.id]=this,this.updateFunction=e.updateFunction;let t=["getValue","resolveExpression","effect","type","priority","id"];Object.keys(e).forEach(s=>{this[s]=e[s]})}static getInstance(e){return this.updaters[e]}type=!1;init(e){}updateFunction(){}nodes=new WeakMap;registerHelper(e,t){let[s,r]=t.expression.split(":");t.expression=s,t.debug=r,this.registerExpression(s);let i=s,o=this.expressions[i];return{...t,expression:o,raw:i,helper:e}}getNodeObject(e){if(this.nodes.has(e))return this.nodes.get(e);let t={expressions:{}};return this.nodes.set(e,t),t}getUpdatePayload(){return{ctx:this.ctx}}runUpdate(e){this.nodes.forEach(({node:t,payload:s})=>{this.runNodeUpdate(t,s,e)})}effect(){return this.getValue(...arguments)}getValue({expression:e},t){return $(t,e)}getPropertyTarget(e,t){for(;!e.hasOwnProperty(t);){if(e.hasOwnProperty(t))return e;let s=Object.getPrototypeOf(e);if(s)e=s;else return e}return e}getValueWithPayload(e,t){let s=e.expression||e,r=s;return s=this.expressions[s],this.getValue(e,t.data)}expressions={};registerExpression(e){if(this.expressions[e])return;let t=e;this.resolveExpression&&(t=this.resolveExpression(e)),this.expressions[e]=t}forceUpdate(e,t,s){if(e.__inTemplate)return;let r=this.getValueWithPayload(t,s);this.updateFunction(e,{value:r},t,s)}runNodeUpdate(e,t,s,r){if(e.__inTemplate)return;let i=this.getValueWithPayload(t,s),o=this.getNodeObject(e);if(o.originalUpdate)return;if(o.originalUpdate=r,!this.effect){this.updateFunction(e,{value:i},t,s);return}let a=this._effectUpdates=this._effectUpdates||new WeakMap,c=!a.get(r),d=a.get(r);d||(d=[],a.set(r,d)),d.push({payload:t,node:e,ctx:s}),this.updateFunction(e,{value:i},t,s),c&&(t.expression.includes(","),this.effect,Z(()=>this.getValueWithPayload(t,s),p=>{a.get(r).forEach(({node:u,payload:U,ctx:x},O)=>{let M=this.getValueWithPayload(U,x);U.debug,this.updateFunction(u,{...p,value:M},U,x)})},{deep:this.deep??!0,updater:this}))}},Ne=new w({priority:3,id:"text",updateFunction(n,{value:e},{expression:t,debug:s},r){n.dataset&&n.dataset.la,e&&e.attrs,typeof e=="object"&&(e=JSON.stringify(e)),n.textContent=e}}),Te=new w({priority:4,id:"attrs",updateFunction(n,{value:e,oldValue:t},{key:s,expression:r},i){s=="onkeypress",n.setAttribute(s,e),s=="value"&&(n.value=e,n.__inputEvent||(n.__inputEvent=!0,v(()=>{n.addEventListener("input",o=>{J(i.data,r,o.target.value),v(()=>{n.focus()})})})))}}),be=new Map,Ee=new w({priority:5,id:"events",effect:!1,updateFunction(n,{value:e},{expression:t,key:s},r){v(()=>{this.setupEvent(n,s,t,r)})}});Object.assign(Ee,{setupEvent(n,e,t,s){let r=this.nodes.get(n);r||(r={},be.set(n,r));let i=e,o=r.listening=r.listening||{},a=s.data;if(o[e]){if(o[e].includes(n))return;o[e].push(n);let l=r.eventCallbacks[e];v(()=>{n.addEventListener(i,u=>{c.includes(n)&&l.call(a,u,n,a)})});return}let c=o[e]=o[e]||[];if(r.listening[e].includes(n))return;r.listening[e].push(n);let d=t;if(!Q["on"+e])return;let p=this.getEventFunction(d);r.eventCallbacks=r.eventCallbacks||{},r.eventCallbacks[e]=p,v(()=>{n.addEventListener(i,l=>{c.includes(n)&&p.call(a,l,n,a)})})},getEventFunction(n){let e,t,s,r,i="";n.startsWith("(")&&(t=!0),n.match(/^[a-zA-Z]/)&&(s=!0),n.includes("(")||(i="(event, node)");let o="",a=`this.${n}${i}`;t&&(o=n.match(/\{.+\(([^)]+)\)/)?.[1]||"",a=`(${n})(event)`),s&&(o=n.match(/\(([^)]+)\)/)?.[1]||"");let c=`
            
                let {${o}} = this
        
                ${a}   
            `;return new Function("event","node","ctx","window",c)}});Object.entries(H).forEach(([n,e])=>{new w({id:n,...e})});function Y(n){return typeof n!="object"?n:n.__raw||n}function we(n,e){let t=[],s=[],r=[],i=[],o=new Set,a=new Set;if(Array.isArray(n)&&Array.isArray(e)){let d=new Map;e.forEach((p,l)=>d.set(p,l));for(let p=0;p<n.length;p++){let l=n[p];o.add(typeof l);let u=d.get(l);u!==void 0?(p===u?(i.push([p,l]),a.add("keep")):(r.push([p,l,u,e[u]]),a.add("move")),d.delete(l)):(t.push([p,l]),a.add("add"))}d.forEach((p,l)=>{o.add(typeof l),s.push([p,l]),a.add("remove")})}else{let d=Object.keys(n),p=Object.keys(e),l=new Set(p);d.forEach(u=>{o.add(typeof n[u]),e.hasOwnProperty(u)?(n[u]===e[u]?(i.push([u,n[u]]),a.add("keep")):(r.push([u,n[u],u,e[u]]),a.add("move")),l.delete(u)):(t.push([u,n[u]]),a.add("add"))}),l.forEach(u=>{o.add(typeof e[u]),s.push([u,e[u]]),a.add("remove")})}return{jobs:Array.from(a),toAdd:t,toRemove:s,toReposition:r,toKeep:i,types:Array.from(o)}}function ee(n,e,t){me(n,e,(s,r)=>{let i=N.get(s);i&&i.runNodeUpdates(r,t)})}})();
//# sourceMappingURL=out.js.map
